# 项目结构说明

```
screen_sync/
├── server.py                 # 服务器端（CentOS/Linux/Windows）
├── client_sender.py          # 发送端（捕获并发送屏幕）
├── client_receiver.py        # 接收端（接收并显示屏幕）
├── requirements.txt          # Python 依赖
├── README.md                 # 详细文档
├── 快速开始.md               # 快速入门指南
├── 项目结构.md               # 本文件
├── config.example.json       # 配置文件示例
├── start_server.sh           # Linux 服务器启动脚本
├── start_sender.bat          # Windows 发送端启动脚本
├── start_receiver.bat        # Windows 接收端启动脚本
└── test_local.bat            # 本地测试脚本
```

## 核心文件说明

### server.py
- **用途**: 中转服务器，接收发送端数据并转发给接收端
- **部署位置**: CentOS 服务器或任意有公网 IP 的机器
- **依赖**: 仅需 Python 3.6+，无需额外库
- **功能**:
  - 接受多个发送端连接
  - 接受多个接收端连接
  - 实时转发屏幕数据
  - 统计信息显示

### client_sender.py
- **用途**: 捕获本地屏幕并发送到服务器
- **运行位置**: 要分享屏幕的电脑（Windows/Linux）
- **依赖**: Pillow（用于截图和压缩）
- **功能**:
  - 捕获屏幕右侧 1/4 区域
  - JPEG 压缩
  - 可配置帧率
  - 自动重连
  - 实时统计

### client_receiver.py
- **用途**: 从服务器接收屏幕数据并显示
- **运行位置**: 要查看屏幕的电脑（Windows/Linux）
- **依赖**: Pillow, tkinter（GUI）
- **功能**:
  - 接收屏幕数据
  - GUI 窗口显示
  - 自动缩放适应窗口
  - 实时统计

## 数据流

```
[发送端电脑]                [服务器]                [接收端电脑]
    |                          |                          |
    | 1. 截图右侧 1/4          |                          |
    |------------------------->|                          |
    | 2. JPEG 压缩             |                          |
    |                          | 3. 转发数据              |
    |                          |------------------------->|
    |                          |                          | 4. 解码显示
    |                          |                          |
```

## 网络协议

### 连接建立
1. 客户端连接到服务器
2. 发送配置信息（JSON 格式）
3. 服务器识别客户端类型（发送端/接收端）

### 数据传输
- 每帧数据格式：`[4字节大小][JPEG数据]`
- 大小使用网络字节序（big-endian）
- JPEG 质量可配置（默认 75）

## 配置参数

### 服务器
- `host`: 监听地址（0.0.0.0 表示所有接口）
- `port`: 监听端口（默认 5003）

### 发送端
- `server_host`: 服务器地址
- `server_port`: 服务器端口
- `fps`: 帧率（默认 4）
- `quality`: JPEG 质量（1-100，默认 75）

### 接收端
- `server_host`: 服务器地址
- `server_port`: 服务器端口
- `sender_id`: 订阅的发送端 ID

## 性能优化建议

### 降低延迟
1. 提高帧率（增加 CPU 和带宽消耗）
2. 使用有线网络
3. 服务器部署在网络中心位置

### 降低带宽
1. 降低帧率
2. 降低 JPEG 质量
3. 减小捕获区域
4. 使用更高效的编码（H.264）

### 降低 CPU 占用
1. 降低帧率
2. 减小捕获区域
3. 降低 JPEG 质量

## 扩展功能建议

- [ ] 加密传输（SSL/TLS）
- [ ] 身份验证
- [ ] H.264 视频编码
- [ ] 音频传输
- [ ] 鼠标键盘控制
- [ ] 多显示器支持
- [ ] 录制功能
- [ ] Web 界面
